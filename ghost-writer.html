<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GHOST-WRITER | ESTATE EDITION</title>
    <link rel="stylesheet" href="https://unpkg.com/easymde/dist/easymde.min.css">
    <script src="https://unpkg.com/easymde/dist/easymde.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Fira+Code:wght@300;500&display=swap');

        :root {
            /* Your 3-Color Brand Schema */
            --brand-blue: #6395EE;
            --brand-teal: #91AFB3;
            --brand-light-blue: #A0BEF5;
            --bg-dark: #050505;
        }

        body {
            background-color: var(--bg-dark);
            color: white;
            font-family: 'Inter', sans-serif;
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh; margin: 0; padding: 20px;
        }

        /* 1. BRANDED LOGIN SCREEN */
        #auth-container {
            width: 100%; max-width: 400px; padding: 40px;
            background: rgba(255, 255, 255, 0.02); 
            border: 1px solid rgba(99, 149, 238, 0.3); /* Brand Blue Tint */
            text-align: center;
            backdrop-filter: blur(10px);
        }

        #passwordInput {
            background: transparent; border: none; border-bottom: 2px solid var(--brand-blue);
            padding: 10px; color: var(--brand-light-blue); font-family: 'Fira Code', monospace;
            font-size: 1.2rem; width: 80%; text-align: center; outline: none; margin-bottom: 30px;
        }

        .btn-action {
            background: var(--brand-blue); color: var(--bg-dark); border: none;
            padding: 14px 28px; font-weight: 700; font-size: 0.8rem;
            cursor: pointer; width: 100%; text-transform: uppercase; letter-spacing: 4px;
            transition: 0.4s;
        }
        .btn-action:hover { background: var(--brand-light-blue); box-shadow: 0 0 20px rgba(160, 190, 245, 0.4); }

        /* 2. THE WRITER INTERFACE */
        #main-content { display: none; width: 100%; max-width: 1000px; }

        .writer-case {
            background: rgba(255, 255, 255, 0.01);
            padding: 50px; border: 1px solid rgba(255,255,255,0.05);
            box-shadow: 0 40px 100px rgba(0,0,0,0.8);
        }

        .input-row { display: flex; gap: 30px; margin-bottom: 30px; align-items: center; }
        
        input#title {
            background: transparent; border: none; border-bottom: 2px solid rgba(255,255,255,0.1);
            color: white; font-size: 2.5rem; font-weight: 900; 
            flex-grow: 1; outline: none; letter-spacing: -1px;
        }
        
        input#entryDate {
            background: rgba(145, 175, 179, 0.1); /* Brand Teal Tint */
            border: 1px solid var(--brand-teal);
            color: var(--brand-teal); font-family: 'Fira Code', monospace;
            padding: 8px 15px; border-radius: 4px; font-size: 0.9rem; outline: none;
        }

        /* DARK MODE EDITOR THEME */
        .EasyMDEContainer { font-family: 'Inter', sans-serif !important; }
        .CodeMirror { 
            background: transparent !important; color: #ccc !important; 
            border: 1px solid rgba(255,255,255,0.1) !important; height: 500px !important; 
            font-size: 1.1rem; line-height: 1.6;
        }
        .editor-toolbar { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-bottom: none; }
        .editor-toolbar button { color: #888 !important; }
        .editor-toolbar button.active, .editor-toolbar button:hover { background: rgba(99, 149, 238, 0.1) !important; color: var(--brand-blue) !important; }

        .publish-footer { margin-top: 40px; display: flex; justify-content: flex-end; }

        @media (max-width: 768px) {
            .writer-case { padding: 30px 20px; }
            .input-row { flex-direction: column; align-items: flex-start; }
            input#title { font-size: 1.8rem; width: 100%; }
        }
    </style>
</head>
<body>

    <div id="auth-container">
        <div style="font-size: 0.7rem; letter-spacing: 5px; color: var(--brand-teal); margin-bottom: 20px; text-transform: uppercase;">System Access</div>
        <input type="password" id="passwordInput" placeholder="••••••••" autofocus>
        <button class="btn-action" onclick="login()">Initialize Session</button>
    </div>

    <div id="main-content">
        <div class="writer-case">
            <div class="input-row">
                <input type="text" id="title" placeholder="Entry Title...">
                <input type="date" id="entryDate">
            </div>
            
            <textarea id="content"></textarea>

            <div class="publish-footer">
                <button type="button" id="downloadBtn" class="btn-action" style="width: auto; padding: 18px 80px;">Execute Publish Sequence</button>
            </div>
        </div>
    </div>

    <script>
        // Set Default Date (AZ)
        const now = new Date();
        const azTime = new Date(now.getTime() + (-7 * 60 + now.getTimezoneOffset()) * 60000);
        document.getElementById('entryDate').value = azTime.toISOString().split('T')[0];

        // Initialize Rich Editor with Estate Branding
        const easyMDE = new EasyMDE({
            element: document.getElementById('content'),
            forceSync: true,
            spellChecker: false,
            status: false,
            toolbar: ["bold", "italic", "heading", "|", "quote", "unordered-list", "ordered-list", "|", "preview", "side-by-side", "fullscreen"]
        });

        function login() {
            if (document.getElementById('passwordInput').value === 'Stockton12!') {
                document.getElementById('auth-container').style.display = 'none';
                document.getElementById('main-content').style.display = 'block';
                easyMDE.codemirror.refresh();
            } else { alert('ACCESS DENIED'); }
        }

        document.getElementById('passwordInput').addEventListener('keypress', (e) => { if (e.key === 'Enter') login(); });

        document.getElementById('downloadBtn').addEventListener('click', () => {
            const title = document.getElementById('title').value;
            const chosenDate = document.getElementById('entryDate').value;
            const content = easyMDE.value();

            if (!title || !content || !chosenDate) { alert("ERROR: NARRATIVE INCOMPLETE"); return; }

            // POETRY FIX: Double-spacing for line breaks
            const formattedContent = content.replace(/\n/g, "  \n");
            
            const dateOptions = { year: 'numeric', month: 'long', day: 'numeric' };
            const formattedDate = new Date(chosenDate + 'T00:00:00').toLocaleDateString('en-US', dateOptions);

            const fullMarkdown = `# ${title}\n### ${formattedDate}\n\n---\n\n${formattedContent}`;

            const fileName = `${chosenDate}-${title.toLowerCase().replace(/[^a-z0-9]/g, '-')}.md`;
            const blob = new Blob([fullMarkdown], { type: 'text/markdown' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = fileName;
            a.click();
        });
    </script>
</body>
</html>